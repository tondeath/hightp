install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
library(VennDiagram)
grid.newpage()
draw.pairwise.venn(581, 485, 346, category = c("ERa", "ERb"),
lty = rep("blank", 2), fill = c("green", "light blue"))
llibrary(tidyverse)
library(tidyverse)
install.packages("ape")
??melt
?melt
library(reshape2)
?melt
llibrary(pheatmap)
library(pheatmap)
knitr::opts_chunk$set(echo = TRUE)
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
library(tidyverse)
library(IsoformSwitchAnalyzeR)
setwd("/home/nuttapong/Desktop/block4/hightp/homework3/HW3_combined_handout/")
wt1_quant <- read_tsv("./HW3_combined_handout/salmon_result_part1/salmon_result_part1/WT1/quant.sf")
setwd("/home/nuttapong/Desktop/block4/hightp/homework3/HW3_combined_handout/")
wt1_quant <- read_tsv("./HW3_combined_handout/salmon_result_part1/salmon_result_part1/WT1/quant.sf")
wt1_quant %>% ggplot(aes(x=Length, y=EffectiveLength)) +
scale_x_continuous(trans='log10') + scale_y_continuous(trans='log10')  +
geom_point(alpha=0.3) +
geom_smooth() + geom_abline(color = "red", linetype=2)
all_salmons <- importIsoformExpression(parentDir = "./HW3_combined_handout/salmon_result_part1/salmon_result_part1/")
salmon_matrix <- as.matrix(all_salmons$abundance[,2:ncol(all_salmons$abundance)])
rownames(salmon_matrix) <- all_salmons$abundance[,1]
transformed_salmon <- log2(salmon_matrix+1)
transformed_salmon[1:4,]
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
top100var <- salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance))  %>% slice(1:100)
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance))  %>% slice(1:100)
setwd("/home/nuttapong/Desktop/block4/hightp/homework3/HW3_combined_handout/")
wt1_quant <- read_tsv("./HW3_combined_handout/salmon_result_part1/salmon_result_part1/WT1/quant.sf")
wt1_quant %>% ggplot(aes(x=Length, y=EffectiveLength)) +
scale_x_continuous(trans='log10') + scale_y_continuous(trans='log10')  +
geom_point(alpha=0.3) +
geom_smooth() + geom_abline(color = "red", linetype=2)
all_salmons <- importIsoformExpression(parentDir = "./HW3_combined_handout/salmon_result_part1/salmon_result_part1/")
salmon_matrix <- as.matrix(all_salmons$abundance[,2:ncol(all_salmons$abundance)])
rownames(salmon_matrix) <- all_salmons$abundance[,1]
transformed_salmon <- log2(salmon_matrix+1)
transformed_salmon[1:4,]
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance))  %>% slice(1:5)
View(salmon_tibble)
View(salmon_tibble)
salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3)))
salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance))
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance)) %>% slice(1:5)
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance))
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
top100var <- salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance)) %>% slice_(1:100)
View(top100var)
View(top100var)
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
top100var <- salmon_tibble %>% add_rownames() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance))
salmon_tibble %>% rownames_to_column() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3)))
salmon_tibble %>% rownames_to_column() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance)) slice_(1:100)
salmon_tibble %>% rownames_to_column() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance)) %>% slice_(1:100)
salmon_tibble %>% rownames_to_column() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance)) %>% slice_(1:5)
salmon_tibble %>% rownames_to_column() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance)) %>% slice(1:5)
library(IsoformSwitchAnalyzeR)
library(tidyverse)
salmon_tibble <- as_tibble(transformed_salmon, rownames=NA)
top100var <- salmon_tibble %>% rownames_to_column() %>% rowwise() %>%
mutate(variance=var(c(WT1, WT2, WT3, WTTPA1, WTTPA2, WTTPA3))) %>%
arrange(desc(variance)) %>% slice(1:100)
